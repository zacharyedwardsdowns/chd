#!/bin/bash
cd "$(dirname "$0")" || (
  echo -e "\nFailed to change directory at [$0: $LINENO]"
  exit 1
)

chddir=$(pwd) # Store the installation directory into chddir.

# Add $HOME into chddir
home='$HOME'
prefix="/home/$USER"
chddir=${chddir#"$prefix"}
chddir="$home$chddir"
chddir="${chddir/$HOME/""}"

tab='    ' # For appropriate spacing.

# Add the directory to .bashrc.
echo '' >>~/.bashrc
echo '# Adds chd to path.' >>~/.bashrc
echo "if [ -d "$chddir" ]; then" >>~/.bashrc

# Create the proper variable to add to path.
pathchd='PATH="'
pathchd+="$chddir"
pathchd+=':$PATH'
pathchd+='"'
echo "$tab$pathchd" >>~/.bashrc
echo 'fi' >>~/.bashrc

# Add the alias to .bashrc.
echo '' >>~/.bashrc
echo '# Alias to run chd.sh as chd.' >>~/.bashrc
echo "alias chd='. chd.sh'" >>~/.bashrc

# Tell the user a terminal restart is needed.
echo 'Changes made to ~/.bashrc.'
echo 'Restart your terminal to use the chd command line tool!'
